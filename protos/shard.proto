syntax = "proto3";

package protos;

option go_package = "github.com/CaptainIRS/sharded-kvs/internal";

import "protos/kv.proto";

service ShardRPC {
    rpc Get(GetRequest) returns (GetResponse) {}
    rpc Put(InternalPutRequest) returns (PutResponse) {}
    rpc Delete(DeleteRequest) returns (DeleteResponse) {}
    rpc PauseWrites(PauseWritesRequest) returns (PauseWritesResponse) {}
    rpc RedistributeKeys(RedistributeKeysRequest) returns (RedistributeKeysResponse) {}
    rpc ResumeWrites(ResumeWritesRequest) returns (ResumeWritesResponse) {}
}

message PauseWritesRequest {}
message PauseWritesResponse {
    bool is_paused = 1;
}

message RedistributeKeysRequest {}
message RedistributeKeysResponse {
    int32 pending_keys = 1;
}

message ResumeWritesRequest {}
message ResumeWritesResponse {
    bool is_resumed = 1;
}

message InternalPutRequest {
    string key = 1;
    string value = 2;
    bool is_redistribution = 3;
}
